(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b1f2ae2"],{"2c65":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-select",e._g(e._b({ref:"dragSelect",staticClass:"drag-select",attrs:{multiple:"",filterable:""},model:{value:e.selectVal,callback:function(t){e.selectVal=t},expression:"selectVal"}},"el-select",e.$attrs,!1),e.$listeners),[e._t("default")],2)},a=[],i=r("75fc"),s=r("53fe"),o=r.n(s),l={name:"DragSelect",props:{value:{type:Array,required:!0}},computed:{selectVal:{get:function(){return Object(i["a"])(this.value)},set:function(e){this.$emit("input",Object(i["a"])(e))}}},mounted:function(){this.setSort()},methods:{setSort:function(){var e=this,t=this.$refs.dragSelect.$el.querySelectorAll(".el-select__tags > span")[0];this.sortable=o.a.create(t,{ghostClass:"sortable-ghost",setData:function(e){e.setData("Text","")},onEnd:function(t){var r=e.value.splice(t.oldIndex,1)[0];e.value.splice(t.newIndex,0,r)}})}}},c=l,u=(r("d9e4"),r("2877")),h=Object(u["a"])(c,n,a,!1,null,"2c27c150",null);t["a"]=h.exports},"5d51":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return o}));var n=r("b775");function a(e){return Object(n["a"])({url:"/v1/rolelists",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/v1/rolelists",method:"post",data:e})}function s(e,t){return Object(n["a"])({url:"/v1/rolelists/".concat(e),method:"put",data:t})}function o(e){return Object(n["a"])({url:"/v1/rolelists/".concat(e),method:"get"})}},8789:function(e,t,r){},a417:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("b775");function a(e){return Object(n["a"])({url:"/v1/options",method:"get",params:e})}},a817:function(e,t,r){"use strict";var n=r("8789"),a=r.n(n);a.a},c1e4:function(e,t,r){"use strict";var n=[{path:"/permission",name:"Permission",meta:{title:"权限模块"},children:[{hidden:!0,path:"createrole",name:"RolePermissioncreate",meta:{title:"新建角色"}},{hidden:!0,path:"updaterole/:id(\\d+)",name:"RolePermissionupdate",meta:{title:"更新角色"}},{path:"userlist",name:"userslist",meta:{title:"用户列表"}},{path:"rolelist",name:"RolePermissionlist",meta:{title:"角色列表"}},{path:"grouplist",name:"grouplist",meta:{title:"权限组"}},{path:"urllist",name:"urllist",meta:{title:"权限列表"}}]}];t["a"]=n},d02c:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.isLoading?r("div",{staticClass:"app-container"},[r("el-form",{attrs:{model:e.role,"label-width":"80px","label-position":"left"}},[r("el-form-item",{attrs:{label:"角色"}},[r("el-input",{attrs:{placeholder:"Role Name"},model:{value:e.role.role_name,callback:function(t){e.$set(e.role,"role_name",t)},expression:"role.role_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"描述"}},[r("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"Role Description"},model:{value:e.role.description,callback:function(t){e.$set(e.role,"description",t)},expression:"role.description"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"权限组"}},[r("el-drag-select",{staticStyle:{width:"500px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.role.permissions_group,callback:function(t){e.$set(e.role,"permissions_group",t)},expression:"role.permissions_group"}},e._l(e.options,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e._v(" "),r("div",{staticStyle:{"margin-top":"30px"}},e._l(e.role.permissions_group,(function(t){return r("el-tag",{key:t,staticStyle:{"margin-right":"15px"}},[e._v("\n        "+e._s(e.groups[t])+"\n      ")])})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"权限"}},[r("el-transfer",{attrs:{filterable:"",titles:["左","右"],"filter-placeholder":"请输入",data:e.transferdata},model:{value:e.role.permissions,callback:function(t){e.$set(e.role,"permissions",t)},expression:"role.permissions"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"导航栏"}},[r("el-tree",{ref:"tree",staticClass:"permission-tree",attrs:{"check-strictly":e.checkStrictly,data:e.routesData,props:e.defaultProps,"show-checkbox":"","node-key":"path"}})],1)],1),e._v(" "),r("div",{staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{type:"primary"},on:{click:e.confirmRole}},[e._v("确认")])],1)],1):e._e()},a=[],i=r("db72"),s=(r("6762"),r("2fdb"),r("75fc")),o=(r("ac4d"),r("8a81"),r("456d"),r("ac6a"),r("96cf"),r("3b8d")),l=r("df7c"),c=r.n(l),u=r("ed08"),h=r("5d51"),d=r("2c65"),p=r("c1e4"),f=r("a417"),m=(r("036d"),{key:"",role_name:"",description:"",menus:[],permissions:[]}),g={components:{ElDragSelect:d["a"]},data:function(){return{isLoading:!1,role:Object.assign({},m),routes:[],rolesList:[],dialogVisible:!1,dialogType:"new",checkStrictly:!1,defaultProps:{children:"children",label:"title"},options_key:{key:"permissions"},groups_key:{key:"group_name"},value:[],options:[],transferdata:[],groups:[]}},computed:{routesData:function(){return this.routes}},created:function(){this.getRoutes(),this.getPermissions(),this.getGroups(),this.showRoles()},methods:{getRoutes:function(){this.serviceRoutes=p["a"],this.routes=this.generateRoutes(p["a"])},showRoles:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=this.$route.params&&this.$route.params.id,Object(h["c"])(t).then((function(e){var t=e.data;r.role=t,r.changeView(),r.isLoading=!0,r.$nextTick((function(){var e=r.generateRoutes(r.role.menus);r.$refs.tree.setCheckedNodes(r.generateArr(e)),r.checkStrictly=!1}))}));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),changeView:function(){this.$store.dispatch("tagsView/changeView",{fullPath:this.$route.fullPath,newtitle:this.role.role_name})},closeSelectedTag:function(){this.$store.dispatch("tagsView/delView",this.$route)},getPermissions:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Object(f["a"])(this.options_key).then((function(e){var r=[],n=e.data;Object.keys(n).forEach((function(e){r.push({label:n[e],key:e})})),t.transferdata=r}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getGroups:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Object(f["a"])(this.groups_key).then((function(e){var r=[],n=e.data;Object.keys(n).forEach((function(e){r.push({label:n[e],value:e})})),t.options=r,t.groups=n}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),generateRoutes:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value;if(!l.hidden){var u=this.onlyOneShowingChild(l.children,l);l.children&&u&&!l.alwaysShow&&(l=u);var h={path:c.a.resolve(t,l.path),title:l.meta&&l.meta.title};l.children&&(h.children=this.generateRoutes(l.children,h.path)),r.push(h)}}}catch(d){a=!0,i=d}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r},generateArr:function(e){var t=this,r=[];return e.forEach((function(e){if(r.push(e),e.children){var n=t.generateArr(e.children);n.length>0&&(r=[].concat(Object(s["a"])(r),Object(s["a"])(n)))}})),r},generateTree:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",r=arguments.length>2?arguments[2]:void 0,n=[],a=!0,i=!1,s=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var u=o.value,h=c.a.resolve(t,u.path);u.children&&(u.children=this.generateTree(u.children,h,r)),(r.includes(h)||u.children&&u.children.length>=1)&&n.push(u)}}catch(d){i=!0,s=d}finally{try{a||null==l.return||l.return()}finally{if(i)throw s}}return n},confirmRole:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=this.$refs.tree.getCheckedKeys(),r=this.$route.params&&this.$route.params.id,this.role.menus=this.generateTree(Object(u["c"])(this.serviceRoutes),"/",t),Object(h["d"])(r,this.role).then((function(){n.$notify({title:"Success",type:"success",duration:2e3})})),this.closeSelectedTag(),this.$router.back();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onlyOneShowingChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=null,n=e.filter((function(e){return!e.hidden}));return 1===n.length?(r=n[0],r.path=c.a.resolve(t.path,r.path),r):0===n.length&&(r=Object(i["a"])({},t,{path:"",noShowingChildren:!0}),r)}}},v=g,b=(r("a817"),r("2877")),y=Object(b["a"])(v,n,a,!1,null,"2e02ce88",null);t["default"]=y.exports},d9e4:function(e,t,r){"use strict";var n=r("e4c2"),a=r.n(n);a.a},e4c2:function(e,t,r){}}]);