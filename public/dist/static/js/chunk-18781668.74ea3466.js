(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18781668"],{"175c":function(e,t,r){"use strict";var n=r("d5c8"),a=r.n(n);a.a},"2c65":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-select",e._g(e._b({ref:"dragSelect",staticClass:"drag-select",attrs:{multiple:""},model:{value:e.selectVal,callback:function(t){e.selectVal=t},expression:"selectVal"}},"el-select",e.$attrs,!1),e.$listeners),[e._t("default")],2)},a=[],i=r("75fc"),l=r("53fe"),s=r.n(l),o={name:"DragSelect",props:{value:{type:Array,required:!0}},computed:{selectVal:{get:function(){return Object(i["a"])(this.value)},set:function(e){this.$emit("input",Object(i["a"])(e))}}},mounted:function(){this.setSort()},methods:{setSort:function(){var e=this,t=this.$refs.dragSelect.$el.querySelectorAll(".el-select__tags > span")[0];this.sortable=s.a.create(t,{ghostClass:"sortable-ghost",setData:function(e){e.setData("Text","")},onEnd:function(t){var r=e.value.splice(t.oldIndex,1)[0];e.value.splice(t.newIndex,0,r)}})}}},c=o,u=(r("ef96"),r("2877")),h=Object(u["a"])(c,n,a,!1,null,"46cab54a",null);t["a"]=h.exports},"31f0":function(e,t,r){},"5d51":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return l})),r.d(t,"c",(function(){return s}));var n=r("b775");function a(e){return Object(n["a"])({url:"/v1/rolelists",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/v1/rolelists",method:"post",data:e})}function l(e,t){return Object(n["a"])({url:"/v1/rolelists/".concat(e),method:"put",data:t})}function s(e){return Object(n["a"])({url:"/v1/rolelists/".concat(e),method:"get"})}},a417:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("b775");function a(e){return Object(n["a"])({url:"/v1/options",method:"get",params:e})}},c1e4:function(e,t,r){"use strict";var n=[{path:"/permission",name:"Permission",meta:{title:"权限模块"},children:[{hidden:!0,path:"createrole",name:"RolePermissioncreate",meta:{title:"新建角色"}},{hidden:!0,path:"updaterole/:id(\\d+)",name:"RolePermissionupdate",meta:{title:"更新角色"}},{path:"rolelist",name:"RolePermissionlist",meta:{title:"角色列表"}},{path:"urllist",name:"urllist",meta:{title:"接口列表"}},{path:"userlist",name:"userslist",meta:{title:"用户列表"}}]}];t["a"]=n},d02c:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.isLoading?r("div",{staticClass:"app-container"},[r("el-form",{attrs:{model:e.role,"label-width":"80px","label-position":"left"}},[r("el-form-item",{attrs:{label:"角色"}},[r("el-input",{attrs:{placeholder:"Role Name"},model:{value:e.role.role_name,callback:function(t){e.$set(e.role,"role_name",t)},expression:"role.role_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"描述"}},[r("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"Role Description"},model:{value:e.role.description,callback:function(t){e.$set(e.role,"description",t)},expression:"role.description"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"权限"}},[r("el-transfer",{attrs:{filterable:"",titles:["左","右"],"filter-placeholder":"请输入",data:e.transferdata},model:{value:e.role.permissions,callback:function(t){e.$set(e.role,"permissions",t)},expression:"role.permissions"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"导航栏"}},[r("el-tree",{ref:"tree",staticClass:"permission-tree",attrs:{"check-strictly":e.checkStrictly,data:e.routesData,props:e.defaultProps,"show-checkbox":"","node-key":"path"}})],1)],1),e._v(" "),r("div",{staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{type:"primary"},on:{click:e.confirmRole}},[e._v("确认")])],1)],1):e._e()},a=[],i=r("db72"),l=(r("96cf"),r("3b8d")),s=(r("6762"),r("2fdb"),r("75fc")),o=(r("ac4d"),r("8a81"),r("456d"),r("ac6a"),r("df7c")),c=r.n(o),u=r("ed08"),h=r("5d51"),d=r("2c65"),f=r("c1e4"),p=r("a417"),m=(r("036d"),{key:"",role_name:"",description:"",menus:[],permissions:[]}),v={components:{ElDragSelect:d["a"]},data:function(){return{isLoading:!1,role:Object.assign({},m),routes:[],rolesList:[],dialogVisible:!1,dialogType:"new",checkStrictly:!1,defaultProps:{children:"children",label:"title"},options_key:{key:"permissions"},value:[],options:[{value:"Apple",label:"Apple"},{value:"Banana",label:"Banana"},{value:"Orange",label:"Orange"},{value:"Pear",label:"Pear"},{value:"Strawberry",label:"Strawberry"}],transferdata:[]}},computed:{routesData:function(){return this.routes}},created:function(){this.getRoutes(),this.getPermissions(),this.showRoles()},methods:{getRoutes:function(){this.serviceRoutes=f["a"],this.routes=this.generateRoutes(f["a"])},showRoles:function(){var e=this,t=this.$route.params&&this.$route.params.id;Object(h["c"])(t).then((function(t){var r=t.data;e.role=r,e.changeView(),e.isLoading=!0,e.$nextTick((function(){var t=e.generateRoutes(e.role.menus);e.$refs.tree.setCheckedNodes(e.generateArr(t)),e.checkStrictly=!1}))}))},changeView:function(){this.$store.dispatch("tagsView/changeView",{fullPath:this.$route.fullPath,newtitle:this.role.role_name})},getPermissions:function(){var e=this;Object(p["a"])(this.options_key).then((function(t){var r=[],n=t.data;Object.keys(n).forEach((function(e){r.push({label:n[e],key:e})})),e.transferdata=r}))},generateRoutes:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",r=[],n=!0,a=!1,i=void 0;try{for(var l,s=e[Symbol.iterator]();!(n=(l=s.next()).done);n=!0){var o=l.value;if(!o.hidden){var u=this.onlyOneShowingChild(o.children,o);o.children&&u&&!o.alwaysShow&&(o=u);var h={path:c.a.resolve(t,o.path),title:o.meta&&o.meta.title};o.children&&(h.children=this.generateRoutes(o.children,h.path)),r.push(h)}}}catch(d){a=!0,i=d}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r},generateArr:function(e){var t=this,r=[];return e.forEach((function(e){if(r.push(e),e.children){var n=t.generateArr(e.children);n.length>0&&(r=[].concat(Object(s["a"])(r),Object(s["a"])(n)))}})),r},generateTree:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",r=arguments.length>2?arguments[2]:void 0,n=[],a=!0,i=!1,l=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var u=s.value,h=c.a.resolve(t,u.path);u.children&&(u.children=this.generateTree(u.children,h,r)),(r.includes(h)||u.children&&u.children.length>=1)&&n.push(u)}}catch(d){i=!0,l=d}finally{try{a||null==o.return||o.return()}finally{if(i)throw l}}return n},confirmRole:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,r,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=this.$refs.tree.getCheckedKeys(),r=this.$route.params&&this.$route.params.id,this.role.menus=this.generateTree(Object(u["c"])(this.serviceRoutes),"/",t),Object(h["d"])(r,this.role).then((function(){n.$notify({title:"Success",type:"success",duration:2e3})})),this.$router.push({name:"RolePermissionlist"});case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onlyOneShowingChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=null,n=e.filter((function(e){return!e.hidden}));return 1===n.length?(r=n[0],r.path=c.a.resolve(t.path,r.path),r):0===n.length&&(r=Object(i["a"])({},t,{path:"",noShowingChildren:!0}),r)}}},b=v,g=(r("175c"),r("2877")),y=Object(g["a"])(b,n,a,!1,null,"5a2abc2e",null);t["default"]=y.exports},d5c8:function(e,t,r){},ef96:function(e,t,r){"use strict";var n=r("31f0"),a=r.n(n);a.a}}]);